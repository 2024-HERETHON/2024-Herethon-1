<!DOCTYPE html>
{% load bootstrap4 %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <div style="text-align: center; max-width: 500px; margin: 4rem auto;">
        <div class="mb-4">
            <h4>SignUp</h4>
        </div>
        <form action="{% url 'accountApp:create' %}" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="form-group">
                {{ form.email.label_tag }}
                {{ form.email }}
                <button type="button" id="check-email-btn" class="btn btn-primary">Check Email</button>
            </div>
            {{ form.as_p }}
            <input type="submit" class="btn btn-dark rounded-pill col-6 mt-3">
        </form>
        <div id="email-check-result"></div>
    </div>

    <script>
        $(document).ready(function() {
            $('#check-email-btn').click(function() {
                var email = $('#id_email').val();
                $.ajax({
                    url: "{% url 'accountApp:check_email' %}",
                    data: {
                        'email': email
                    },
                    dataType: 'json',
                    success: function (data) {
                        if (data.is_taken) {
                            $('#email-check-result').html('<p style="color: red;">Email is already taken.</p>');
                        } else {
                            $('#email-check-result').html('<p style="color: green;">Email is available.</p>');
                        }
                    }
                });
            });
        });
    </script>
</body>
</html>
